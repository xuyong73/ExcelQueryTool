<Window x:Class="ExcelQueryTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ExcelQueryTool"
        mc:Ignorable="d"
        Title="ExcelQueryTool" 
        Height="515" 
        MinWidth="816"
        WindowState="Maximized"
        AllowDrop="True"
        Drop="Window_Drop"
        DragEnter="Window_DragEnter">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 第一行：文件操作区域 -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10,10,10,5">
            <Button x:Name="btnOpenFile" Content="打开文件" Width="75" Height="23" Click="BtnOpenFile_Click" Margin="0,0,10,0"/>
            <Label x:Name="lblFilePath" Content="请选择Excel文件！" VerticalAlignment="Center" Margin="0,0,10,0" Width="339"/>
            <Label Content="选择工作表：" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <ComboBox x:Name="comboBoxWorksheets" Width="207" Height="25" SelectionChanged="ComboBoxWorksheets_SelectedIndexChanged"/>
        </StackPanel>

        <!-- 第二行：搜索区域 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="10,0,10,5">
            <Label Content="查询内容：" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <TextBox x:Name="txtKeyword" Width="339" Height="23" VerticalAlignment="Center" 
                     PreviewKeyDown="TxtKeyword_PreviewKeyDown" 
                     ToolTip="搜索语法：!代表非，+或空格代表和，,或；代表或"/>
            <Button x:Name="btnSearch" Content="搜索" Width="141" Height="23" Margin="10,0,0,0" Click="BtnSearch_Click"/>
            <CheckBox x:Name="chkShowImages" Content="显示图片" VerticalAlignment="Center" Margin="20,0,0,0" 
                      Checked="ChkShowImages_CheckedChanged" Unchecked="ChkShowImages_CheckedChanged"/>
        </StackPanel>

        <!-- 第三行：数据表格区域 -->
        <Border Grid.Row="2" Margin="10,0,10,5" BorderBrush="LightGray" BorderThickness="1">
            <DataGrid x:Name="dataGridViewResults" 
                      AutoGenerateColumns="False"
                      VirtualizingStackPanel.IsVirtualizing="True"
                      VirtualizingStackPanel.VirtualizationMode="Recycling"
                      VirtualizingStackPanel.CleanUpVirtualizedItem="DataGrid_CleanUpVirtualizedItem"
                      EnableColumnVirtualization="True"
                      EnableRowVirtualization="True"
                      ScrollViewer.CanContentScroll="True"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      CanUserSortColumns="False"
                      CanUserReorderColumns="False"
                      CanUserResizeColumns="True"
                      CanUserResizeRows="True"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      SelectionMode="Single"
                      SelectionUnit="FullRow"
                      ColumnWidth="Auto"
                      HeadersVisibility="All"
                      AllowDrop="True"
                      Drop="DataGrid_Drop"
                      DragEnter="DataGrid_DragEnter"
                      Loaded="DataGridViewResults_Loaded"
                      LayoutUpdated="DataGridViewResults_LayoutUpdated"
                      GridLinesVisibility="All"
                      HorizontalGridLinesBrush="LightGray"
                      VerticalGridLinesBrush="LightGray"
                      RowHeight="30"
                      RowHeaderWidth="60">
                <DataGrid.RowHeaderStyle>
                    <Style TargetType="DataGridRowHeader">
                        <Setter Property="Content" Value="{Binding RowNumber}"/>
                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                        <Setter Property="VerticalContentAlignment" Value="Center"/>
                        <Setter Property="Background" Value="LightGray"/>
                        <Setter Property="BorderBrush" Value="DarkGray"/>
                        <Setter Property="BorderThickness" Value="1"/>
                        <Setter Property="Cursor" Value="SizeNS"/>
                        <Setter Property="ToolTip" Value="拖动调整行高"/>
                        <Setter Property="MinWidth" Value="60"/>
                        <Setter Property="Padding" Value="5,0"/>
                    </Style>
                </DataGrid.RowHeaderStyle>
                <DataGrid.RowStyle>
                    <Style TargetType="DataGridRow">
                        <Setter Property="BorderBrush" Value="LightGray"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="MinHeight" Value="30"/>
                    </Style>
                </DataGrid.RowStyle>
            </DataGrid>
        </Border>

        <!-- 第四行：状态栏 -->
        <StatusBar Grid.Row="3" Grid.Column="0">
            <StatusBarItem HorizontalAlignment="Left">
                <TextBlock x:Name="toolStripStatusLabel" Text="本工具用于快速搜索Excel工作表中符合要求的数据记录。" 
                           VerticalAlignment="Center" Margin="10,0,0,0"/>
            </StatusBarItem>
            <StatusBarItem HorizontalAlignment="Stretch" Width="Auto"/>
            <StatusBarItem HorizontalAlignment="Right">
                <TextBlock x:Name="toolStripStatusLabel1" Text="欢迎使用Excel工作表快速搜索工具        版本：v3.0" 
                           Foreground="Blue" FontWeight="Bold" Margin="0,0,10,0"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
