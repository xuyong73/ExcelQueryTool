# ExcelQueryTool

ExcelQueryTool 是一个高效、易用的 Excel 文件查询工具，专为快速搜索和浏览 Excel 工作表数据而设计。

## 功能特点

- 📁 **文件操作**
  - 支持打开 `.xlsx` 和 `.xls` 格式的 Excel 文件
  - 支持拖放文件快速打开
  - 自动检测并显示工作表列表

- 🔍 **强大的搜索功能**
  - 支持复杂搜索语法（`!` 非，`+`/空格 `和`，`,`/`;` `或`）
  - 实时搜索结果显示
  - 搜索结果行数统计
  - 支持大小写不敏感搜索

- 🖼️ **图片支持**
  - 可选显示 Excel 中的图片
  - 图片自动缩放
  - 高效的图片缓存管理

- 📊 **数据展示**
  - 虚拟滚动加载，支持处理大量数据
  - 自定义列宽和行高
  - 数据表格支持行号显示
  - 支持手动调整行高和列宽

- ⚡ **高性能**
  - 异步加载数据，不阻塞 UI
  - 批量处理数据，优化内存使用
  - 自动清理资源，防止内存泄漏

## 系统要求

- Windows 7 或更高版本
- .NET 10.0 运行时

## 使用方法

![ExcelQueryTool](https://github.com/xuyong73/ExcelQueryTool/blob/main/mainform.png)

### 打开 Excel 文件

1. 点击「打开文件」按钮选择要查询的 Excel 文件
2. 或直接将 Excel 文件拖放到应用程序窗口
3. 选择要查询的工作表

### 搜索数据

1. 在「查询内容」文本框中输入搜索关键词
2. 点击「搜索」按钮或按 Enter 键开始搜索
3. 查看搜索结果

### 搜索语法

| 语法 | 说明 | 示例 |
|------|------|------|
| `!` | 非（排除包含指定关键词的行） | `!苹果` 查找不包含「苹果」的行 |
| `+` 或空格 | 和（必须同时包含所有关键词） | `苹果 + 香蕉` 或 `苹果 香蕉` 查找同时包含「苹果」和「香蕉」的行 |
| `,` 或 `;` | 或（包含任意一个关键词即可） | `苹果,香蕉` 或 `苹果;香蕉` 查找包含「苹果」或「香蕉」的行 |

### 高级操作

- **显示/隐藏图片**：勾选/取消勾选「显示图片」复选框
- **切换工作表**：在下拉菜单中选择不同的工作表
- **调整列宽**：拖动列标题之间的分隔线
- **调整行高**：拖动行号旁边的分隔线

## 技术架构

- **开发框架**：WPF (.NET 10.0)
- **Excel 处理库**：EPPlus 8.4.0
- **UI 设计**：XAML
- **异步编程**：Task-based Async Pattern
- **数据虚拟化**：VirtualizingStackPanel

## 性能优化

- 采用数据虚拟化技术，仅渲染可见区域的数据
- 图片缓存机制，减少内存占用
- 异步加载和搜索，保持 UI 响应流畅
- 批量处理数据，提高加载速度
- 自动内存管理，防止内存泄漏

## 常见问题

### Q: 为什么无法打开某些 Excel 文件？
A: 请确保文件格式为 `.xlsx` 或 `.xls`，并且文件未被其他程序占用。

### Q: 搜索结果不准确？
A: 请检查搜索语法是否正确，确保关键词之间的逻辑关系符合预期。

### Q: 图片显示不完整？
A: 图片会自动缩放以适应单元格大小，您可以手动调整行高和列宽来查看完整图片。

### Q: 程序运行缓慢？
A: 对于包含大量数据的 Excel 文件，首次加载可能需要一些时间。建议关闭图片显示功能以提高性能。

## 版本历史

- v3.0 主要更新：
  - 优化了图片加载和缓存机制
  - 增加了虚拟滚动支持
  - 改进了搜索算法
  - 修复了已知 bug

## 许可证

本项目采用非商业用途许可证，基于 EPPlus 的非商业个人使用许可。

---

**ExcelQueryTool - 让 Excel 数据查询更简单、更高效！**
